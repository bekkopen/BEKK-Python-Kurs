<!DOCTYPE html>
<html>
  <head>
    <title>Python-kurs, NTNU, 2012</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

    <script src="https://github.com/downloads/gnab/remark/remark-0.3.1.min.js" type="text/javascript">
      { "highlightStyle": "solarized_light" }
    </script>
    <script src="../lib/jquery-1.7.1.js" type="text/javascript"></script>
    <script src="../lib/bekk.js" type="text/javascript"></script>

    <link href='../lib/Inconsolata.css' rel='stylesheet' type='text/css'>

    <link rel="stylesheet/less" type="text/css" href="../lib/bekk.less">
    <script src="../lib/less-1.1.5.min.js" type="text/javascript"></script>
  </head>
  <body>
    <textarea id="source">

.front-page

# Python-kurs

## Del 3: Webprogrammering med Django!

Forelesning ved NTNU

Håkon Erichsen og Ole Christian Rynning

21/03/2012

---

.agenda

# Agenda

* Django's arkitektur
* Kom igang!
* Modell, visning og kontrollere
* Administrasjonsgrensesnitt
* Autentisering med Facebook
* Release!

---

# Django's arkitektur

TODO: MVC, projects -> apps, pluggbarhet (plugins)

---

# Kom igang!

For dagens kurs vil vi dekke Django 1.3

    curl -O http://www.djangoproject.com/download/1.3.1/tarball/
    tar xzvf Django-1.3.1.tar.gz
    sudo python setup.py install

---

# Opprett prosjekt

    django-admin.py startproject del3
    cd del3
    python manage.py runserver

---

# Grunnleggende konfigurasjon (settings.py)

* ADMINS
* DATABASE [ENGINE, NAME]
* TIME_ZONE

---

# Opprett applikasjon

    python manage.py startapp todo

---

# Modeller

* Kobling til databasen
* Forskjellige felttyper
* syncdb
* Syntaks

---

# Oppgave

* Lag en modell `Task`, som har et felt for tekst, og et heltallsfelt for rekkefølge.
* Kjør `python manage.py syncdb` for å lage modellen 

---

# Fasit

    from django.db import models

    class Task (models.Model):
        text = models.CharField(max_length=1000)
        place = models.IntegerField(default=0)

---

# ORM-EN

Object Relational Mapper, Django håndterer SQL for oss:

    User.objects.all() # Hent ut alle tasks
    User.objects.get(id=3) # Hent ut bare én
    User.objects.filter(age=20) # Hent ut alle med alder lik 20

    u = User(name="Håkon", age=22) # Lager en bruker Håkon, men lagrer det IKKE i databasen
    u.save() # Lagrer det i databasen
    print u.id # Etter lagring har objektet fått en ID

---

# Views

Hver metode tilsvarer én side. Views kobler sammen data (modeller) med presentasjon (templates):
    
    def index (request):

        # Laste inn objekter, 
        # lagre objekter fra forms, 
        # regne ut ting, f.eks:
        user = User.objects.get(id=1)

        return render(request, 'index.html', {'user': user}) # Viser templaten 'index.html', og gjør `user` tilgjengelig i templaten.

For at et view skal være tilgjengelig må du gi det en URL i `urls.py`:

    urlpatterns = patterns('',
        url(r'^$', 'app.views.index'), # Sier at URL-en / skal gå til metoden index
    )

---

# Templates

Templates er rett og slett HTML, med et eget språk i tillegg:

    <h1>Hello {{ user }}</h1>
    <p>You are {{ user.age }} years old! </p>

    {% if user.age >= 18 %}
        <p>And you can buy alcohol!</p>
    {% endif %}

Objektet `user` kommer fra templaten:

    return render(request, 'index.html', {'user': user})

---

# Oppgave

* Lag et view `overview` i `todo/views.py` som skal vise alle tasks
* Lag en template til dette viewet

    Tips! Iterere gjennom en liste:
    {% for task in tasks %}
        <li>{{ task.text }}</li>
    {% endfor }

* Gi viewet ditt en URL, slik at du kan nå det, og teste det

---

# Fasit

todo/views.py:

    from django.shortcuts import render
    from del3.todo.models import Task

    def overview (request):
        tasks = Task.objects.all()    
        
        return render(request, 'todo/overview.html', {'tasks': tasks})

todo/templates/todo/overview.html

    <h2>Tasks</h2>
    
    <ul>
        {% for task in tasks %}
            <li>{{ task.text }}</li>
        {% endfor %}
    </ul>

urls.py
    
    urlpatterns = patterns('',
        url(r'^$', 'todo.views.overview'),
    )

---

# Admin


---

# Auth


---

# Deploy



---

# Bugfix


---

.middle.center

# Spørsmål?

Kom og jobb hos [oss i BEKK](http://www.bekk.no/jobb/stillinger/)

    </textarea>
    <div id="slideshow"></div>
  </body>
</html>
